import{r as o,g as Be,a as Ve,R as M,j as t,_ as $e,b as We,s as Ze}from"./index-10043ab0.js";const Ue=(e,s,n,i)=>{var r,g,f,u;const c=[n,{code:s,...i||{}}];if((g=(r=e==null?void 0:e.services)==null?void 0:r.logger)!=null&&g.forward)return e.services.logger.forward(c,"warn","react-i18next::",!0);D(c[0])&&(c[0]=`react-i18next:: ${c[0]}`),(u=(f=e==null?void 0:e.services)==null?void 0:f.logger)!=null&&u.warn?e.services.logger.warn(...c):console!=null&&console.warn&&console.warn(...c)},xe={},ne=(e,s,n,i)=>{D(n)&&xe[n]||(D(n)&&(xe[n]=new Date),Ue(e,s,n,i))},ye=(e,s)=>()=>{if(e.isInitialized)s();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),s()};e.on("initialized",n)}},ae=(e,s,n)=>{e.loadNamespaces(s,ye(e,n))},ve=(e,s,n,i)=>{if(D(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(s)>-1)return ae(e,n,i);n.forEach(c=>{e.options.ns.indexOf(c)<0&&e.options.ns.push(c)}),e.loadLanguages(s,ye(e,i))},Ke=(e,s,n={})=>!s.languages||!s.languages.length?(ne(s,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:s.languages}),!0):s.hasLoadedNamespace(e,{lng:n.lng,precheck:(i,c)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&i.services.backendConnector.backend&&i.isLanguageChangingTo&&!c(i.isLanguageChangingTo,e))return!1}}),D=e=>typeof e=="string",Ge=e=>typeof e=="object"&&e!==null,Je=o.createContext();class qe{constructor(){this.usedNamespaces={}}addUsedNamespaces(s){s.forEach(n=>{this.usedNamespaces[n]||(this.usedNamespaces[n]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Ye=(e,s)=>{const n=o.useRef();return o.useEffect(()=>{n.current=s?n.current:e},[e,s]),n.current},Ne=(e,s,n,i)=>e.getFixedT(s,n,i),Xe=(e,s,n,i)=>o.useCallback(Ne(e,s,n,i),[e,s,n,i]),ke=(e,s={})=>{var L,H,Z,A;const{i18n:n}=s,{i18n:i,defaultNS:c}=o.useContext(Je)||{},r=n||i||Ve();if(r&&!r.reportNamespaces&&(r.reportNamespaces=new qe),!r){ne(r,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const m=(y,j)=>D(j)?j:Ge(j)&&D(j.defaultValue)?j.defaultValue:Array.isArray(y)?y[y.length-1]:y,k=[m,{},!1];return k.t=m,k.i18n={},k.ready=!1,k}(L=r.options.react)!=null&&L.wait&&ne(r,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const g={...Be(),...r.options.react,...s},{useSuspense:f,keyPrefix:u}=g;let p=e||c||((H=r.options)==null?void 0:H.defaultNS);p=D(p)?[p]:p||["translation"],(A=(Z=r.reportNamespaces).addUsedNamespaces)==null||A.call(Z,p);const x=(r.isInitialized||r.initializedStoreOnce)&&p.every(m=>Ke(m,r,g)),w=Xe(r,s.lng||null,g.nsMode==="fallback"?p:p[0],u),S=()=>w,h=()=>Ne(r,s.lng||null,g.nsMode==="fallback"?p:p[0],u),[T,_]=o.useState(S);let N=p.join();s.lng&&(N=`${s.lng}${N}`);const P=Ye(N),b=o.useRef(!0);o.useEffect(()=>{const{bindI18n:m,bindI18nStore:k}=g;b.current=!0,!x&&!f&&(s.lng?ve(r,s.lng,p,()=>{b.current&&_(h)}):ae(r,p,()=>{b.current&&_(h)})),x&&P&&P!==N&&b.current&&_(h);const y=()=>{b.current&&_(h)};return m&&(r==null||r.on(m,y)),k&&(r==null||r.store.on(k,y)),()=>{b.current=!1,r&&m&&(m==null||m.split(" ").forEach(j=>r.off(j,y))),k&&r&&k.split(" ").forEach(j=>r.store.off(j,y))}},[r,N]),o.useEffect(()=>{b.current&&x&&_(S)},[r,u,x]);const z=[T,r,x];if(z.t=T,z.i18n=r,z.ready=x,x||!x&&!f)return z;throw new Promise(m=>{s.lng?ve(r,s.lng,p,()=>m()):ae(r,p,()=>m())})};var we={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},je=M.createContext&&M.createContext(we),Qe=["attr","size","title"];function et(e,s){if(e==null)return{};var n=tt(e,s),i,c;if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(c=0;c<r.length;c++)i=r[c],!(s.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(e,i)&&(n[i]=e[i])}return n}function tt(e,s){if(e==null)return{};var n={};for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){if(s.indexOf(i)>=0)continue;n[i]=e[i]}return n}function K(){return K=Object.assign?Object.assign.bind():function(e){for(var s=1;s<arguments.length;s++){var n=arguments[s];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},K.apply(this,arguments)}function be(e,s){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);s&&(i=i.filter(function(c){return Object.getOwnPropertyDescriptor(e,c).enumerable})),n.push.apply(n,i)}return n}function G(e){for(var s=1;s<arguments.length;s++){var n=arguments[s]!=null?arguments[s]:{};s%2?be(Object(n),!0).forEach(function(i){st(e,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):be(Object(n)).forEach(function(i){Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(n,i))})}return e}function st(e,s,n){return s=nt(s),s in e?Object.defineProperty(e,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[s]=n,e}function nt(e){var s=at(e,"string");return typeof s=="symbol"?s:s+""}function at(e,s){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var i=n.call(e,s||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(s==="string"?String:Number)(e)}function Se(e){return e&&e.map((s,n)=>M.createElement(s.tag,G({key:n},s.attr),Se(s.child)))}function C(e){return s=>M.createElement(rt,K({attr:G({},e.attr)},s),Se(e.child))}function rt(e){var s=n=>{var{attr:i,size:c,title:r}=e,g=et(e,Qe),f=c||n.size||"1em",u;return n.className&&(u=n.className),e.className&&(u=(u?u+" ":"")+e.className),M.createElement("svg",K({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,g,{className:u,style:G(G({color:e.color||n.color},n.style),e.style),height:f,width:f,xmlns:"http://www.w3.org/2000/svg"}),r&&M.createElement("title",null,r),e.children)};return je!==void 0?M.createElement(je.Consumer,null,n=>s(n)):s(we)}function it(e){return C({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M257.5 445.1l-22.2 22.2c-9.4 9.4-24.6 9.4-33.9 0L7 273c-9.4-9.4-9.4-24.6 0-33.9L201.4 44.7c9.4-9.4 24.6-9.4 33.9 0l22.2 22.2c9.5 9.5 9.3 25-.4 34.3L136.6 216H424c13.3 0 24 10.7 24 24v32c0 13.3-10.7 24-24 24H136.6l120.5 114.8c9.8 9.3 10 24.8.4 34.3z"},child:[]}]})(e)}function ct(e){return C({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937 0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154 0l239.94 416.028zM288 354c-25.405 0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346l7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373 0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884 0-12.356 5.78-11.981 12.654z"},child:[]}]})(e)}function ot(e){return C({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm64 236c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-64c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12v8zm0-72v8c0 6.6-5.4 12-12 12H108c-6.6 0-12-5.4-12-12v-8c0-6.6 5.4-12 12-12h168c6.6 0 12 5.4 12 12zm96-114.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"},child:[]}]})(e)}function V(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504.971 199.362l-22.627-22.627c-9.373-9.373-24.569-9.373-33.941 0l-5.657 5.657L329.608 69.255l5.657-5.657c9.373-9.373 9.373-24.569 0-33.941L312.638 7.029c-9.373-9.373-24.569-9.373-33.941 0L154.246 131.48c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l5.657-5.657 39.598 39.598-81.04 81.04-5.657-5.657c-12.497-12.497-32.758-12.497-45.255 0L9.373 412.118c-12.497 12.497-12.497 32.758 0 45.255l45.255 45.255c12.497 12.497 32.758 12.497 45.255 0l114.745-114.745c12.497-12.497 12.497-32.758 0-45.255l-5.657-5.657 81.04-81.04 39.598 39.598-5.657 5.657c-9.373 9.373-9.373 24.569 0 33.941l22.627 22.627c9.373 9.373 24.569 9.373 33.941 0l124.451-124.451c9.372-9.372 9.372-24.568 0-33.941z"},child:[]}]})(e)}function lt(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196 0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627 0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627 0 12 5.373 12 12v100h12c6.627 0 12 5.373 12 12v24z"},child:[]}]})(e)}function dt(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M476 3.2L12.5 270.6c-18.1 10.4-15.8 35.6 2.2 43.2L121 358.4l287.3-253.2c5.5-4.9 13.3 2.6 8.6 8.3L176 407v80.5c0 23.6 28.5 32.9 42.5 15.8L282 426l124.6 52.2c14.2 6 30.4-2.9 33-18.2l72-432C515 7.8 493.3-6.8 476 3.2z"},child:[]}]})(e)}function ht(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M493.4 24.6l-104-24c-11.3-2.6-22.9 3.3-27.5 13.9l-48 112c-4.2 9.8-1.4 21.3 6.9 28l60.6 49.6c-36 76.7-98.9 140.5-177.2 177.2l-49.6-60.6c-6.8-8.3-18.2-11.1-28-6.9l-112 48C3.9 366.5-2 378.1.6 389.4l24 104C27.1 504.2 36.7 512 48 512c256.1 0 464-207.5 464-464 0-11.2-7.7-20.9-18.6-23.4z"},child:[]}]})(e)}function ut(e){return C({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M500.33 0h-47.41a12 12 0 0 0-12 12.57l4 82.76A247.42 247.42 0 0 0 256 8C119.34 8 7.9 119.53 8 256.19 8.1 393.07 119.1 504 256 504a247.1 247.1 0 0 0 166.18-63.91 12 12 0 0 0 .48-17.43l-34-34a12 12 0 0 0-16.38-.55A176 176 0 1 1 402.1 157.8l-101.53-4.87a12 12 0 0 0-12.57 12v47.41a12 12 0 0 0 12 12h200.33a12 12 0 0 0 12-12V12a12 12 0 0 0-12-12z"},child:[]}]})(e)}function pt(e){return C({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M32,224H64V416H32A31.96166,31.96166,0,0,1,0,384V256A31.96166,31.96166,0,0,1,32,224Zm512-48V448a64.06328,64.06328,0,0,1-64,64H160a64.06328,64.06328,0,0,1-64-64V176a79.974,79.974,0,0,1,80-80H288V32a32,32,0,0,1,64,0V96H464A79.974,79.974,0,0,1,544,176ZM264,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,264,256Zm-8,128H192v32h64Zm96,0H288v32h64ZM456,256a40,40,0,1,0-40,40A39.997,39.997,0,0,0,456,256Zm-8,128H384v32h64ZM640,256V384a31.96166,31.96166,0,0,1-32,32H576V224h32A31.96166,31.96166,0,0,1,640,256Z"},child:[]}]})(e)}function mt(e){return C({tag:"svg",attr:{viewBox:"0 0 352 512"},child:[{tag:"path",attr:{d:"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z"},child:[]}]})(e)}const $=()=>{const{t:e}=ke(),[s,n]=o.useState(!1),i=[{name:e("emergency.resources.emsName"),phone:"911",description:e("emergency.resources.emsDesc"),color:"#dc2626"},{name:e("emergency.resources.ndvName"),phone:"1-800-799-7233",description:e("emergency.resources.ndvDesc"),color:"#ea580c"},{name:e("emergency.resources.idvName"),phone:"1-877-863-6338",description:e("emergency.resources.idvDesc"),color:"#d97706"},{name:e("emergency.resources.lifelineName"),phone:"988",description:e("emergency.resources.lifelineDesc"),color:"#7c3aed"},{name:e("emergency.resources.dcfsName"),phone:"1-800-252-2873",description:e("emergency.resources.dcfsDesc"),color:"#0891b2"},{name:e("emergency.resources.rainnName"),phone:"1-800-656-4673",description:e("emergency.resources.rainnDesc"),color:"#db2777"}];return t.jsxs(t.Fragment,{children:[t.jsxs("button",{className:"emergency-floating-button",onClick:()=>n(!0),title:e("emergency.button"),children:[t.jsx(ct,{size:24}),t.jsx("span",{children:e("emergency.button")})]}),s&&t.jsx("div",{className:"emergency-modal-overlay",onClick:()=>n(!1),children:t.jsxs("div",{className:"emergency-modal",onClick:c=>c.stopPropagation(),children:[t.jsxs("div",{className:"emergency-modal-header",children:[t.jsx("h2",{children:e("emergency.title")}),t.jsx("button",{className:"emergency-close-btn",onClick:()=>n(!1),children:t.jsx(mt,{size:24})})]}),t.jsxs("div",{className:"emergency-modal-body",children:[t.jsx("p",{className:"emergency-warning",children:e("emergency.warning")}),t.jsx("div",{className:"emergency-resources-grid",children:i.map((c,r)=>t.jsxs("div",{className:"emergency-resource-card",style:{borderLeftColor:c.color},children:[t.jsx("h3",{children:c.name}),t.jsx("p",{children:c.description}),t.jsxs("a",{href:`tel:${c.phone.replace(/[^0-9]/g,"")}`,className:"emergency-call-button",style:{background:c.color},children:["üìû Call ",c.phone]})]},r))}),t.jsxs("div",{className:"emergency-safety-notice",children:[t.jsx("strong",{children:e("emergency.safetyNoteTitle")}),e("emergency.safetyNoteText"),t.jsx("button",{className:"quick-exit-button",onClick:()=>window.location.href="https://www.google.com",children:e("emergency.quickExit")})]})]})]})})]})},gt=o.lazy(()=>$e(()=>import("./AIChat-435ba9a1.js"),["assets/AIChat-435ba9a1.js","assets/index-10043ab0.js","assets/index-b3238d13.css","assets/AIChat-9978c371.css"])),W="cal_chatbot_state_v1",ee="cal_first_visit_done_v1",te="cal_intake_id_v1",se="cal_intake_saved_v1",ft="https://court-legal-chatbot.onrender.com".replace(/\/+$/,"");function xt(e){const s=String(e||"").trim();return s.includes("@")&&s.includes(".")}function vt(e){const s=String(e||"").replace(/[^0-9]/g,"");return s.length===11&&s.startsWith("1")?s.slice(1):s}function jt(e){return vt(e).length===10}function bt(e){return/^\d{5}$/.test(String(e||"").trim())}function yt(){const{t:e,i18n:s}=ke(),n=We(),[i,c]=o.useState("intake"),[r,g]=o.useState(!1),[f,u]=o.useState(()=>localStorage.getItem(ee)==="1"),[p,x]=o.useState(!1),[w,S]=o.useState([]),[h,T]=o.useState({}),[_,N]=o.useState([]),[P,b]=o.useState(""),[z,L]=o.useState(""),H=o.useRef(null),Z=o.useRef(null),[A,m]=o.useState(()=>localStorage.getItem(te)||""),[k,y]=o.useState(()=>localStorage.getItem(se)==="1"),[j,re]=o.useState(""),[J,ie]=o.useState(""),[q,ce]=o.useState(""),[Y,oe]=o.useState(""),[X,le]=o.useState(""),[de,he]=o.useState(!1),[ue,E]=o.useState("");o.useEffect(()=>{new URLSearchParams(window.location.search).get("fresh")==="1"&&(localStorage.removeItem(ee),localStorage.removeItem(W),x(!1),u(!1),S([]),T({}),N([]),b(""),L(""))},[]),o.useEffect(()=>{document.documentElement.setAttribute("dir","ltr"),document.documentElement.setAttribute("lang",n)},[s.language,s.resolvedLanguage,n]),o.useEffect(()=>{c("intake")},[]);const _e=()=>{var a;(a=H.current)==null||a.scrollIntoView({behavior:"smooth"})};o.useEffect(()=>{w.length>0&&_e()},[w]),o.useEffect(()=>{if(f)try{const a=localStorage.getItem(W);if(!a)return;const d=JSON.parse(a);Array.isArray(d==null?void 0:d.messages)&&S(d.messages),d!=null&&d.conversationState&&typeof d.conversationState=="object"&&(T(d.conversationState),d.conversationState.topic&&L(String(d.conversationState.topic).replace("_"," "))),Array.isArray(d==null?void 0:d.conversationHistory)&&N(d.conversationHistory)}catch(a){console.error("Failed to restore session:",a),localStorage.removeItem(W)}},[f]),o.useEffect(()=>{if(f)try{const a={messages:w,conversationState:h,conversationHistory:_,savedAt:new Date().toISOString()};localStorage.setItem(W,JSON.stringify(a))}catch(a){console.error("Failed to persist session:",a)}},[f,w,h,_]);const F=({variant:a="light"})=>{const d=a==="dark",l={display:"flex",alignItems:"center",gap:"8px",justifyContent:"center",marginTop:d?0:"14px",marginBottom:d?0:"6px",color:d?"white":"#1f2937",fontWeight:700,fontSize:"0.95rem",flexWrap:"wrap"},O={padding:"8px 10px",borderRadius:"10px",border:"2px solid rgba(229,231,235,1)",background:"white",fontWeight:700,cursor:"pointer",color:"#111827"};return t.jsxs("div",{style:l,children:[t.jsxs("span",{children:[e("lang.label"),":"]}),t.jsxs("select",{value:n,onChange:I=>Ze(I.target.value),style:O,"aria-label":e("lang.label"),children:[t.jsx("option",{value:"en",children:e("lang.english")}),t.jsx("option",{value:"es",children:e("lang.spanish")})]})]})},Ce=a=>{if(["child_support","education","housing","divorce","custody"].includes(a))return e(`triage.options.topic_${a}`);const l={yes:"triage.options.yes",no:"triage.options.no",unknown:"triage.options.unknown",not_sure:"triage.options.notSure",continue:"triage.options.continue",restart:"triage.options.restart",connect:"triage.options.connect",continue_to_legal_resources:"triage.options.continueToLegalResources"}[String(a||"").toLowerCase()];return l?e(l):String(a)},Ie=a=>{if(!a)return"";if(typeof a.content=="string"&&a.content.trim().length>0)return a.content;if(a.response_key){const l={...a.response_params&&typeof a.response_params=="object"?a.response_params:{}};return l.topic&&!l.topicLabel&&(l.topicLabel=e(`triage.options.topic_${l.topic}`)),e(a.response_key,l)}return""},Q=a=>`${ft}${a.startsWith("/")?"":"/"}${a}`,Te=async(a,d)=>{if(A)try{await fetch(Q("/intake/event"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({intake_id:A,event_type:a,event_value:d||""})})}catch{}},U=async(a,d=!1)=>{var O;g(!0);const l={role:"user",content:a};S(I=>[...I,l]),b("");try{const I=await fetch(Q("/chat"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:String(a).toLowerCase(),conversation_state:h,language:n,intake_id:A||null})});if(!I.ok)throw new Error(`Server error: ${I.status}`);const v=await I.json();if(v.conversation_state&&v.conversation_state.topic){const R=String(v.conversation_state.topic);L(R.replace("_"," ")),(h==null?void 0:h.step)==="topic_selection"&&Te("topic_selected",R)}const ge={role:"bot",content:v.response||"",response_key:v.response_key,response_params:v.response_params,options:v.options||[],referrals:v.referrals||[]};S(R=>[...R,ge]);const fe={...v.conversation_state||{},progress:v.progress||(((O=v.conversation_state)==null?void 0:O.progress)??{})};T(fe),!d&&v.conversation_state&&N(R=>[...R,{state:fe,allMessages:[...w,l,ge]}])}catch(I){console.error("Connection error details:",I),S(v=>[...v,{role:"bot",content:e("chat.serverDown"),options:[]}])}g(!1)},Ee=()=>{r||(localStorage.setItem(ee,"1"),u(!0),c("chat"),U("start"))},Oe=()=>{x(!1),u(!1),c("cover")},Pe=a=>{a.preventDefault(),P.trim()&&!r&&U(P.trim())},ze=a=>{r||U(a)},Le=()=>{S([]),T({}),N([]),b(""),L(""),x(!1),localStorage.removeItem(W),u(!0),c("chat"),U("start")},Ae=()=>{if(_.length<2){Oe();return}const a=_.slice(0,-1),d=a[a.length-1];N(a),T(d.state),S(d.allMessages)},Me=async()=>{if(E(""),!de){E(e("intake.consentRequired"));return}if(!j.trim()||!J.trim()){E(e("intake.serverError"));return}if(!xt(q)){E(e("intake.invalidEmail"));return}if(!jt(Y)){E(e("intake.invalidPhone"));return}if(!bt(X)){E(e("intake.invalidZip"));return}g(!0);try{const a=await fetch(Q("/intake/start"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({first_name:j.trim(),last_name:J.trim(),email:q.trim().toLowerCase(),phone:Y.trim(),zip:X.trim(),language:n,consent:!0})});if(!a.ok)throw new Error(`intake failed: ${a.status}`);const l=(await a.json()).intake_id;m(l),y(!0),localStorage.setItem(te,l),localStorage.setItem(se,"1"),c("cover")}catch{E(e("intake.serverError"))}finally{g(!1)}},De=()=>{c("cover")},Re=()=>{m(""),y(!1),localStorage.removeItem(te),localStorage.removeItem(se),re(""),ie(""),ce(""),oe(""),le(""),he(!1),E(""),c("intake")};if(p)return t.jsx(o.Suspense,{fallback:t.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:"Loading AI Chat..."}),children:t.jsx(gt,{topic:z,onBack:()=>x(!1)})});if(i==="privacy")return t.jsxs("div",{className:"landing",children:[t.jsx("div",{className:"landing-header",children:t.jsxs("div",{className:"logo-container",children:[t.jsx("div",{className:"icon-circle",children:t.jsx(V,{color:"#fff",size:50})}),t.jsx("h1",{children:e("privacy.title")}),t.jsx("p",{className:"subtitle",children:e("app.subtitle")}),t.jsx(F,{})]})}),t.jsxs("div",{className:"landing-content",children:[t.jsx("p",{className:"tagline",style:{textAlign:"left",lineHeight:1.7},children:e("privacy.body")}),t.jsx("button",{className:"btn btn-primary btn-large btn-start",onClick:()=>c("intake"),disabled:r,children:e("privacy.back")})]}),t.jsx($,{})]});if(i==="intake")return k&&A?t.jsxs("div",{className:"landing",children:[t.jsx("div",{className:"landing-header",children:t.jsxs("div",{className:"logo-container",children:[t.jsx("div",{className:"icon-circle",children:t.jsx(V,{color:"#fff",size:50})}),t.jsx("h1",{children:e("intake.samePersonTitle")}),t.jsx("p",{className:"subtitle",children:e("intake.samePersonBody")}),t.jsx(F,{})]})}),t.jsxs("div",{className:"landing-content",children:[t.jsx("button",{className:"btn btn-start",onClick:De,disabled:r,children:e("intake.samePerson")}),t.jsx("button",{className:"btn btn-start",onClick:Re,disabled:r,style:{marginTop:12,background:"#6b7280"},children:e("intake.newInquiry")}),t.jsx("div",{style:{marginTop:18,textAlign:"center"},children:t.jsx("button",{type:"button",onClick:()=>c("privacy"),style:{background:"transparent",border:"none",color:"#667eea",fontWeight:700,cursor:"pointer",textDecoration:"underline"},children:e("intake.privacyLink")})})]}),t.jsx($,{})]}):t.jsxs("div",{className:"landing",children:[t.jsx("div",{className:"landing-header",children:t.jsxs("div",{className:"logo-container",children:[t.jsx("div",{className:"icon-circle",children:t.jsx(V,{color:"#fff",size:50})}),t.jsx("h1",{children:e("intake.title")}),t.jsx("p",{className:"subtitle",children:e("intake.subtitle")}),t.jsx(F,{})]})}),t.jsx("div",{className:"landing-content",children:t.jsx("form",{onSubmit:a=>{a.preventDefault(),Me()},children:t.jsxs("div",{style:{display:"grid",gap:12},children:[t.jsx("input",{className:"chat-input",type:"text",value:j,onChange:a=>re(a.target.value),placeholder:e("intake.firstName"),disabled:r}),t.jsx("input",{className:"chat-input",type:"text",value:J,onChange:a=>ie(a.target.value),placeholder:e("intake.lastName"),disabled:r}),t.jsx("input",{className:"chat-input",type:"email",value:q,onChange:a=>ce(a.target.value),placeholder:e("intake.email"),disabled:r}),t.jsx("input",{className:"chat-input",type:"tel",value:Y,onChange:a=>oe(a.target.value),placeholder:e("intake.phone"),disabled:r}),t.jsx("input",{className:"chat-input",type:"text",value:X,onChange:a=>le(a.target.value),placeholder:e("intake.zip"),disabled:r}),t.jsxs("label",{style:{display:"flex",gap:10,alignItems:"flex-start",lineHeight:1.4,color:"#374151"},children:[t.jsx("input",{type:"checkbox",checked:de,onChange:a=>he(a.target.checked),disabled:r,style:{marginTop:4}}),t.jsxs("span",{children:[e("intake.consentText")," ",t.jsx("button",{type:"button",onClick:()=>c("privacy"),style:{background:"transparent",border:"none",color:"#667eea",fontWeight:700,cursor:"pointer",textDecoration:"underline",padding:0,marginLeft:6},children:e("intake.privacyLink")})]})]}),ue&&t.jsx("div",{className:"privacy-warning",style:{marginTop:6},children:ue}),t.jsx("button",{className:"btn btn-start",type:"submit",disabled:r,children:e(r?"intake.submitting":"intake.submit")})]})})}),t.jsx($,{})]});if(!f||i==="cover")return t.jsxs("div",{className:"landing",children:[t.jsx("div",{className:"landing-header",children:t.jsxs("div",{className:"logo-container",children:[t.jsx("div",{className:"icon-circle",children:t.jsx(V,{color:"#fff",size:50})}),t.jsx("h1",{children:e("app.title")}),t.jsx("p",{className:"subtitle",children:e("app.subtitle")}),t.jsx(F,{})]})}),t.jsxs("div",{className:"landing-content",children:[t.jsx("h2",{children:e("landing.welcomeTitle")}),t.jsx("p",{className:"tagline",children:e("landing.tagline")}),t.jsxs("div",{className:"topic-cards",children:[t.jsxs("div",{className:"topic-card",children:[t.jsx("div",{className:"topic-icon",children:"üë®‚Äçüë©‚Äçüëß‚Äçüë¶"}),t.jsx("h3",{children:e("landing.topics.childSupportTitle")}),t.jsx("p",{children:e("landing.topics.childSupportDesc")})]}),t.jsxs("div",{className:"topic-card",children:[t.jsx("div",{className:"topic-icon",children:"üéì"}),t.jsx("h3",{children:e("landing.topics.educationTitle")}),t.jsx("p",{children:e("landing.topics.educationDesc")})]}),t.jsxs("div",{className:"topic-card",children:[t.jsx("div",{className:"topic-icon",children:"üè†"}),t.jsx("h3",{children:e("landing.topics.housingTitle")}),t.jsx("p",{children:e("landing.topics.housingDesc")})]}),t.jsxs("div",{className:"topic-card",children:[t.jsx("div",{className:"topic-icon",children:"‚öñÔ∏è"}),t.jsx("h3",{children:e("landing.topics.divorceTitle")}),t.jsx("p",{children:e("landing.topics.divorceDesc")})]}),t.jsxs("div",{className:"topic-card",children:[t.jsx("div",{className:"topic-icon",children:"üë∂üèæ"}),t.jsx("h3",{children:e("landing.topics.custodyTitle")}),t.jsx("p",{children:e("landing.topics.custodyDesc")})]})]}),t.jsx("button",{className:"btn btn-primary btn-large btn-start",onClick:Ee,disabled:r,children:e("landing.begin")}),t.jsxs("div",{className:"disclaimer-box",children:[t.jsx("p",{className:"disclaimer-title",children:e("landing.importantNoticeTitle")}),t.jsx("p",{className:"disclaimer-text",children:t.jsx("strong",{children:e("landing.infoOnly")})}),t.jsxs("p",{className:"privacy-warning",children:["‚ö†Ô∏è ",t.jsx("strong",{children:e("landing.privacyTitle")})," ",e("landing.privacyText")]})]})]}),t.jsx($,{})]});const B=(h==null?void 0:h.progress)||{},pe=Number(B.current||1),me=Number(B.total||5),He=B.label_key?e(B.label_key):String(B.label||e("progress.defaultLabel")),Fe=Math.min(100,Math.max(0,pe/me*100));return t.jsxs("div",{className:"chat-page",children:[t.jsx("div",{className:"chat-header",children:t.jsxs("div",{className:"header-content",children:[t.jsx(V,{size:28,color:"#fff"}),t.jsxs("div",{className:"header-text",children:[t.jsx("h2",{children:e("app.title")}),t.jsx("p",{children:e("app.infoReferrals")})]}),t.jsx("div",{style:{marginLeft:"auto"},children:t.jsx(F,{variant:"dark"})})]})}),w.length>0&&(h==null?void 0:h.step)!=="complete"&&t.jsxs("div",{className:"progress-bar-container",children:[t.jsxs("div",{className:"progress-info",children:[t.jsx("span",{className:"progress-step",children:e("progress.stepOf",{current:pe,total:me})}),t.jsx("span",{className:"progress-label",children:He})]}),t.jsx("div",{className:"progress-bar-track",children:t.jsx("div",{className:"progress-bar-fill",style:{width:`${Fe}%`}})})]}),t.jsxs("div",{className:"chat-container",children:[t.jsxs("div",{className:"messages-container",ref:Z,children:[w.length===0&&!r&&t.jsx("div",{className:"empty-state",children:t.jsx("p",{children:e("chat.starting")})}),w.map((a,d)=>t.jsx("div",{className:`message-wrapper ${a.role}`,children:t.jsx("div",{className:`message ${a.role}`,children:t.jsxs("div",{className:"message-content",children:[a.role==="bot"?Ie(a):a.content,a.referrals&&a.referrals.length>0&&t.jsxs("div",{className:"referrals",children:[t.jsx("h4",{className:"referrals-title",children:e("chat.referralsTitle")}),a.referrals.map((l,O)=>t.jsxs("div",{className:"referral-card",children:[t.jsx("div",{className:"referral-header",children:t.jsx("h3",{children:l.name})}),t.jsx("p",{className:"referral-description",children:l.description}),t.jsxs("div",{className:"referral-contact",children:[l.phone&&l.phone!==""&&t.jsxs("div",{className:"contact-item",children:[t.jsx(ht,{size:14}),t.jsxs("span",{children:[t.jsx("strong",{children:"Intake Phone:"})," ",l.phone]})]}),l.intake_form&&l.intake_form!==""&&t.jsxs("div",{className:"contact-item",children:[t.jsx(ot,{size:14}),t.jsx("a",{href:l.intake_form,target:"_blank",rel:"noopener noreferrer",className:"intake-link",children:"Direct Intake Form"})]}),l.intake_instructions&&l.intake_instructions!==""&&t.jsxs("div",{className:"intake-instructions",children:[t.jsx(lt,{size:14}),t.jsx("span",{children:l.intake_instructions})]})]}),l.is_nfp&&t.jsx("button",{className:"btn btn-nfp-intake",onClick:()=>window.open("https://www.chicagoadvocatelegal.com/contact.html","_blank"),children:"üìÖ Schedule Intake Appointment with Cindy"}),t.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"btn btn-referral",children:"Visit Website ‚Üí"})]},O)),h.step==="complete"&&t.jsxs("div",{className:"ai-assistant-prompt",children:[t.jsxs("button",{className:"btn btn-ai-assistant",onClick:()=>x(!0),children:[t.jsx(pt,{size:18})," ",e("chat.aiButton")]}),t.jsx("p",{className:"ai-assistant-hint",children:e("chat.aiHint")})]})]}),a.options&&a.options.length>0&&t.jsx("div",{className:"options",children:a.options.map((l,O)=>t.jsx("button",{className:"btn btn-option",onClick:()=>ze(l),disabled:r,children:Ce(l)},O))})]})})},d)),r&&t.jsx("div",{className:"message-wrapper bot",children:t.jsx("div",{className:"message bot",children:t.jsxs("div",{className:"typing-indicator",children:[t.jsx("span",{}),t.jsx("span",{}),t.jsx("span",{})]})})}),t.jsx("div",{ref:H})]}),t.jsxs("div",{className:"input-container",children:[t.jsx("button",{onClick:Ae,className:"btn btn-back",title:e("chat.backTitle"),disabled:r,children:t.jsx(it,{size:24})}),t.jsx("button",{onClick:Le,className:"btn btn-restart",title:e("chat.restartTitle"),disabled:r,children:t.jsx(ut,{size:24})}),t.jsxs("form",{onSubmit:Pe,className:"input-form",children:[t.jsx("input",{type:"text",value:P,onChange:a=>b(a.target.value),placeholder:e("chat.placeholder"),disabled:r,className:"chat-input"}),t.jsx("button",{type:"submit",className:"btn btn-send",disabled:r||!P.trim(),title:e("chat.sendTitle"),children:t.jsx(dt,{size:18})})]})]}),t.jsxs("div",{className:"chat-footer",children:[t.jsx("p",{className:"footer-disclaimer",children:t.jsx("strong",{children:e("chat.footerInfoOnly")})}),t.jsxs("p",{className:"footer-privacy-warning",children:["‚ö†Ô∏è ",t.jsx("strong",{children:e("chat.footerPrivacyTitle")})," ",e("chat.footerPrivacyText")]})]})]}),t.jsx($,{})]})}const kt=Object.freeze(Object.defineProperty({__proto__:null,default:yt},Symbol.toStringTag,{value:"Module"}));export{kt as A,ke as u};
